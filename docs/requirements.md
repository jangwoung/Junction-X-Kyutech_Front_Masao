# 衛星操作ゲーム MVP 要件定義書

## 概要

本ゲームは、プレイヤーが「衛星」となり、地上局との通信を通じてミッションを達成する体験を提供する教育的/エンタメ的なゲームです。実際の宇宙データを利用しつつも、ハッカソン MVP では通信・姿勢制御・ミッションカードに焦点を当て、短時間で遊べる体験を実現します。

## 要件

### 要件 1: 衛星選択と初期化

**ユーザーストーリー:** プレイヤーとして、ゲーム開始時に自分の衛星を選択し、ゲームセッションに参加したい。

#### 受入基準

1. WHEN プレイヤーがゲームにアクセス THEN システムは利用可能な衛星のリストを表示する
2. WHEN プレイヤーが衛星を選択 THEN システムはその衛星をプレイヤーに割り当て、ゲームセッションに参加させる
3. WHEN 衛星が選択済み THEN システムは他のプレイヤーがその衛星を選択できないようにする
4. WHEN プレイヤーがゲームセッションに参加 THEN システムは初期スコアを 0 に設定する

### 要件 2: 衛星軌道の可視化

**ユーザーストーリー:** プレイヤーとして、自分の衛星の軌道と地上局の位置を 3D 空間で確認したい。

#### 受入基準

1. WHEN ゲームが開始 THEN システムは Three.js を使用して 3D 空間に地球を表示する
2. WHEN 衛星が選択済み THEN システムはその衛星の軌道を 3D 空間に表示する
3. WHEN 地上局が存在 THEN システムは地上局の位置を地球上にマーカーで表示する
4. WHEN 衛星が軌道上を移動 THEN システムはリアルタイムで衛星の位置を更新する
5. WHEN 衛星と地上局が可視状態 THEN システムは視覚的に接続線を表示する

### 要件 3: 衛星姿勢制御

**ユーザーストーリー:** プレイヤーとして、衛星の姿勢を操作して地上局との通信を確立したい。

#### 受入基準

1. WHEN プレイヤーが姿勢制御インターフェースを操作 THEN システムは衛星の向きを変更する
2. WHEN 衛星の姿勢が変更 THEN システムは 3D 表示で衛星の向きを更新する
3. WHEN 衛星が地上局に正しく指向 THEN システムは通信可能状態を視覚的に示す
4. WHEN 衛星の姿勢が不適切 THEN システムは通信不可状態を表示する

### 要件 4: 通信判定システム

**ユーザーストーリー:** プレイヤーとして、衛星と地上局間の通信条件が満たされた時にデータ送信を実行したい。

#### 受入基準

1. WHEN 衛星と地上局が可視状態 AND 衛星が正しく指向 THEN システムは通信開始ボタンを有効化する
2. WHEN プレイヤーが通信開始ボタンを押下 THEN システムは Go バックエンドで可視条件を判定する
3. WHEN 可視条件（LOS & 仰角しきい値）が満たされる THEN システムはデータ送信成功イベントを生成する
4. WHEN データ送信が成功 THEN システムは成功メッセージを表示する
5. WHEN 可視条件が満たされない THEN システムは失敗メッセージを表示する

### 要件 5: ミッションカードシステム

**ユーザーストーリー:** プレイヤーとして、AI 地上局から提示されるタスクを達成してスコアを獲得したい。

#### 受入基準

1. WHEN ゲームが開始 THEN システムは最初のミッションカードを表示する
2. WHEN ミッションカードが表示 THEN システムは達成条件を明確に示す（例：「東京局でデータ送信」）
3. WHEN プレイヤーがミッション条件を満たす THEN システムはミッション達成を判定する
4. WHEN ミッションが達成 THEN システムはスコアを加算し、新しいミッションカードを提示する
5. WHEN ミッション失敗 THEN システムは現在のミッションを継続する

### 要件 6: スコアリングシステム

**ユーザーストーリー:** プレイヤーとして、自分の成果をスコアで確認し、他のプレイヤーと比較したい。

#### 受入基準

1. WHEN ミッションが達成 THEN システムはミッションの難易度に応じてスコアを加算する
2. WHEN スコアが更新 THEN システムはリアルタイムでスコア表示を更新する
3. WHEN ゲーム中 THEN システムは全プレイヤーのスコアランキングを表示する
4. WHEN 制限時間が終了 THEN システムは最終スコア集計を表示する

### 要件 7: マルチプレイヤー同期

**ユーザーストーリー:** プレイヤーとして、他のプレイヤーの衛星状態と進捗をリアルタイムで確認したい。

#### 受入基準

1. WHEN プレイヤーが衛星を操作 THEN システムは WebSocket で他のプレイヤーに状態を同期する
2. WHEN 他のプレイヤーが操作 THEN システムは自分の画面に他プレイヤーの衛星状態を反映する
3. WHEN プレイヤーがミッションを達成 THEN システムは全プレイヤーに進捗を通知する
4. WHEN 4〜8 人が同時接続 THEN システムは安定してマルチプレイを提供する

### 要件 8: ゲームセッション管理

**ユーザーストーリー:** プレイヤーとして、制限時間内でゲームを完了し、結果を確認したい。

#### 受入基準

1. WHEN ゲームが開始 THEN システムは制限時間（15 分）のカウントダウンを開始する
2. WHEN 制限時間中 THEN システムは残り時間を表示する
3. WHEN 制限時間が終了 THEN システムは全プレイヤーの操作を無効化する
4. WHEN ゲーム終了 THEN システムは最終スコアランキングを表示する
5. WHEN 結果表示後 THEN システムは新しいゲームセッションの開始を可能にする

### 要件 9: ユーザビリティ

**ユーザーストーリー:** 初見プレイヤーとして、短時間でゲームルールを理解し、操作方法を習得したい。

#### 受入基準

1. WHEN 初回プレイヤーがアクセス THEN システムは 5 分以内で理解可能なチュートリアルを提供する
2. WHEN プレイヤーが操作に迷う THEN システムは直感的な UI ガイドを表示する
3. WHEN エラーが発生 THEN システムは分かりやすいエラーメッセージを表示する
4. WHEN ゲーム状態が変化 THEN システムは適切なフィードバックを提供する

### 要件 10: パフォーマンスと安定性

**ユーザーストーリー:** プレイヤーとして、ネットワーク遅延に影響されずに快適にゲームをプレイしたい。

#### 受入基準

1. WHEN ネットワーク遅延が発生 THEN システムは軽量な WebSocket 更新で影響を最小化する
2. WHEN 外部 API が利用不可 THEN システムはキャッシュまたはダミーデータで継続動作する
3. WHEN 複数プレイヤーが同時操作 THEN システムは 1 秒以内に状態同期を完了する
4. WHEN システム負荷が高い THEN システムは 60FPS で 3D 描画を維持する
